<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dishify Admin Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="../main.css" rel="stylesheet">
    <link href="admin.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Production Tailwind CSS -->
    <script src="https://unpkg.com/tailwindcss-jit-cdn"></script>
    <!-- Supabase Client Library -->
    <script src="https://unpkg.com/@supabase/supabase-js"></script>
    <!-- Config -->
    <script src="../config.js"></script>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-brand">
            <a href="../index.html">
                <div class="logo"><span>D</span>ish<i class="fas fa-spoon" style="color: #FF5722; font-size: 0.65em; transform: rotate(135deg);"></i>fy</div>
            </a>
        </div>
        <div class="nav-links">
            <div id="admin-nav-buttons">
                <button id="admin-logout" style="display: none;" class="login-btn">Logout</button>
            </div>
        </div>
    </nav>

    <!-- Login Section -->
    <div id="admin-login-section" class="admin-section">
        <div class="admin-login-container">
            <h2>Admin Login</h2>
            <p class="auth-subtitle">Access the Dishify admin dashboard</p>
            <form id="admin-login-form">
                <div class="form-group">
                    <label for="admin-email">Email</label>
                    <input type="email" id="admin-email" required>
                </div>
                <div class="form-group">
                    <label for="admin-password">Password</label>
                    <input type="password" id="admin-password" required>
                </div>
                <button type="submit" class="login-button">Login to Dashboard</button>
            </form>
        </div>
    </div>

    <!-- Dashboard Section -->
    <div id="admin-dashboard-section" class="admin-section" style="display: none;">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <div class="stats-grid">
                <div class="stat-card">
                    <i class="fas fa-clock"></i>
                    <h3>Pending Approval</h3>
                    <p id="pending-count">67</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle"></i>
                    <h3>Approved Recipes</h3>
                    <p id="approved-count">12</p>
                </div>
                <div class="stat-card">
                    <i class="fas fa-upload"></i>
                    <h3>Total Uploads</h3>
                    <p id="total-count">79</p>
                </div>
            </div>
        </div>

        <!-- Dashboard Actions -->
        <div class="dashboard-actions">
            <button id="add-recipe-btn" class="action-btn" onclick="openSimpleModal()">
                <i class="fas fa-plus"></i> Add New Recipe
            </button>
            <div class="filter-group">
                <select id="status-filter" class="filter-select">
                    <option value="all">All Recipes</option>
                    <option value="pending">Pending Approval</option>
                    <option value="approved">Approved</option>
                    <option value="rejected">Rejected</option>
                </select>
                <input type="text" id="search-recipes" class="search-input" placeholder="Search recipes...">
            </div>
        </div>

        <!-- Recipe Management Tabs -->
        <div class="recipe-tabs">
            <button class="tab-btn active" data-tab="pending">Pending Approval</button>
            <button class="tab-btn" data-tab="approved">Approved Recipes</button>
            <button class="tab-btn" data-tab="all">All Recipes</button>
        </div>

        <!-- Recipes Grid -->
        <div class="recipes-container">
            <div id="pending-recipes" class="recipes-grid">
                <!-- Pending recipes will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Simple Add Recipe Modal -->
    <div id="simple-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000;">
        <div style="position: relative; width: 70%; max-width: 600px; margin: 50px auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                <h2 style="margin: 0; color: #333; font-size: 1.5rem;">Add New Recipe</h2>
                <button onclick="closeSimpleModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
            </div>
            
            <form id="simple-recipe-form" style="margin-top: 15px;">
                <div style="margin-bottom: 12px;">
                    <label style="display: block; margin-bottom: 4px; font-weight: 500; color: #333; font-size: 0.9rem;">Recipe Title</label>
                    <input type="text" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                </div>
                
                <div style="margin-bottom: 12px;">
                    <label style="display: block; margin-bottom: 4px; font-weight: 500; color: #333; font-size: 0.9rem;">Description</label>
                    <textarea rows="2" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;"></textarea>
                </div>
                
                <div style="margin-bottom: 12px;">
                    <label style="display: block; margin-bottom: 4px; font-weight: 500; color: #333; font-size: 0.9rem;">Ingredients</label>
                    <textarea rows="3" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;"></textarea>
                    <small style="color: #666; font-size: 0.8rem;">Enter each ingredient on a new line</small>
                </div>
                
                <div style="margin-bottom: 12px;">
                    <label style="display: block; margin-bottom: 4px; font-weight: 500; color: #333; font-size: 0.9rem;">Instructions</label>
                    <textarea rows="3" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-size: 0.9rem;"></textarea>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 4px; font-weight: 500; color: #333; font-size: 0.9rem;">Recipe Image</label>
                    <input type="file" accept="image/*" style="font-size: 0.9rem;">
                </div>
                
                <div style="text-align: right;">
                    <button type="button" onclick="closeSimpleModal()" style="padding: 8px 12px; background: #f5f5f5; border: 1px solid #ddd; border-radius: 4px; margin-right: 8px; cursor: pointer; font-size: 0.9rem;">Cancel</button>
                    <button type="submit" style="padding: 8px 12px; background: #FF5722; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.9rem;">Add Recipe</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Very simple modal functions
        function openSimpleModal() {
            document.getElementById('simple-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            console.log('Simple modal opened');
        }
        
        function closeSimpleModal() {
            document.getElementById('simple-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            console.log('Simple modal closed');
        }
        
        // Add event listener to button
        document.addEventListener('DOMContentLoaded', function() {
            const addButton = document.getElementById('add-recipe-btn');
            if (addButton) {
                addButton.onclick = function() {
                    openSimpleModal();
                    return false;
                };
                console.log('Added click handler to button');
            } else {
                console.error('Add recipe button not found');
            }
            
            // Close when clicking outside
            const modal = document.getElementById('simple-modal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeSimpleModal();
                    }
                });
            }
            
            // Prevent form submission
            const form = document.getElementById('simple-recipe-form');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    console.log('Form submitted');
                    closeSimpleModal();
                });
            }
        });
    </script>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section brand">
                <div class="footer-logo"><span>D</span>ish<i class="fas fa-spoon" style="color: #FF5722; font-size: 0.65em; transform: rotate(135deg);"></i>fy</div>
                <p class="footer-description">Admin Dashboard</p>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="copyright">
                &copy; <span id="currentYear">2025</span> Dishify. All rights reserved.
            </div>
        </div>
    </footer>

    <script src="adminAuth.js"></script>
    <script src="adminDashboard.js"></script>
</body>
</html>
